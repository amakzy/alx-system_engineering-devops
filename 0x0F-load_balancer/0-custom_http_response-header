#!/usr/bin/env bash

# Update and upgrade the system
apt update && apt upgrade -y

# Install Nginx
apt install nginx -y

# Create a backup of the default Nginx configuration file
cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak

# Create a new Nginx configuration file for the web server
cat << EOF > /etc/nginx/sites-available/nginx.conf
server {
    listen 80;
    server_name ${HOSTNAME};

    location / {
        root /var/www/html;
        index index.html index.htm;
    }

    # Add custom HTTP response header
    add_header X-Served-By $hostname;
}
EOF

# Enable the new Nginx configuration file
ln -s /etc/nginx/sites-available/default.conf /etc/nginx/sites-enabled/

# Restart Nginx
systemctl restart nginx

# Verify the custom HTTP response header is added
curl -sI localhost | grep X-Served-By
